import{v as i,t as o,a as f,f as p,b as v}from"./main-bd493cb3.js";function I(){var t;((t=JSON.parse(localStorage.getItem("userData")))==null?void 0:t.role)==="admin"&&v()&&(location.href="admin-dashboard.html#orders")}I();const{VITE_APP_SITE:h,VITE_APP_ADMIN_IDENTITY:d}={VITE_APP_SITE:"https://two023-dessert-webshop-json-server.onrender.com",VITE_APP_ADMIN_IDENTITY:"528491",BASE_URL:"/2023-Dessert-Webshop-Project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},s=document.querySelector("#admin-login-form"),c=s.querySelectorAll("input"),n=s.querySelector('button[type="submit"]');s.addEventListener("submit",e=>{e.preventDefault();const t=s.querySelector("#identity");c.forEach(r=>i(r)),[...c].every(r=>i(r))&&E(t)&&S()});s.addEventListener("input",e=>{i(e.target)});function E(e){if(e.value!==d){o("error","金鑰錯誤");return}else return!0}function S(){const e=document.querySelector("#account"),t=document.querySelector("#password");f.post(`${h}/login`,{email:e.value,password:t.value}).then(r=>{n.setAttribute("disabled",!0);const{accessToken:a,user:l}=r.data;if(l.role!=="admin")p("您不具備管理員權限","欸！你怎麼會有金鑰 Σ(;ﾟдﾟ)","index.html");else{const u=`${a}${d.split("").map(m=>m.charCodeAt()).join("")}`;localStorage.setItem("token",u),localStorage.setItem("userData",JSON.stringify(l)),o("success","您好！管理員！","admin-dashboard.html")}n.removeAttribute("disabled"),b()}).catch(r=>{if(r.message==="Network Error")o("error","無法連接伺服器，請聯絡管理員");else{const{data:a}=r.response;a==="Incorrect password"?o("error","密碼錯誤"):a==="Cannot find user"&&o("error","用戶不存在"),t.value="",t.classList.remove("is-valid")}n.removeAttribute("disabled")})}function b(){c.forEach(e=>{e.value="",e.classList.remove("is-valid")})}
