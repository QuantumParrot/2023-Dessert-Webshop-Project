import{v as i,t as s,a as f,b as p,g as v}from"./main-7f841a0a.js";function I(){var o;((o=JSON.parse(localStorage.getItem("userData")))==null?void 0:o.role)==="admin"&&v()&&(location.href="admin-dashboard.html#orders")}I();const{VITE_APP_SITE:h,VITE_APP_ADMIN_IDENTITY:d}={VITE_APP_SITE:"https://two023-dessert-webshop-json-server.onrender.com",VITE_APP_ADMIN_IDENTITY:"528491",BASE_URL:"/2023-Dessert-Webshop-Project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},r=document.querySelector("#admin-login-form"),l=r.querySelectorAll("input"),n=r.querySelector('button[type="submit"]');r.addEventListener("submit",function(e){e.preventDefault();const o=r.querySelector("#identity");l.forEach(t=>i(t)),[...l].every(t=>i(t))&&E(o)&&S()});r.addEventListener("input",e=>{i(e.target)});function E(e){return e.value!==d?(s("error","金鑰錯誤"),!1):!0}function S(){const e=document.querySelector("#account"),o=document.querySelector("#password");f.post(`${h}/login`,{email:e.value,password:o.value}).then(t=>{n.setAttribute("disabled",!0);const{accessToken:a,user:c}=t.data;if(c.role!=="admin")p("您不具備管理員權限","欸！你怎麼會有金鑰 Σ(;ﾟдﾟ)","index.html");else{const u=`${a}${d.split("").map(m=>m.charCodeAt()).join("")}`;localStorage.setItem("token",u),localStorage.setItem("userData",JSON.stringify(c)),s("success","您好！管理員！","admin-dashboard.html")}n.removeAttribute("disabled"),b()}).catch(t=>{if(console.log(t),t.message==="Network Error")s("error","無法連接伺服器，請聯絡管理員");else{const{data:a}=t.response;a==="Incorrect password"?s("error","密碼錯誤"):a==="Cannot find user"&&s("error","用戶不存在"),o.value="",o.classList.remove("is-valid")}n.removeAttribute("disabled")})}function b(){l.forEach(e=>{e.value="",e.classList.remove("is-valid")})}
