import{a as E,t as l,g as p}from"./handleAuth-03fa9bb6.js";function A(){p()&&(location.href="index.html")}A();const{VITE_APP_SITE:b}={VITE_APP_SITE:"https://two023-dessert-webshop-json-server.onrender.com",BASE_URL:"/2023-Dessert-Webshop-Project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},c=document.getElementById("username"),u=document.getElementById("account"),r=document.getElementById("password"),m=document.getElementById("password-confirm"),d=document.getElementById("submit"),v=document.querySelectorAll("input");v.forEach(n=>{n.addEventListener("input",e=>{s(e.target)},!1)});function s(n){const{id:e,value:o,classList:t}=n,a=document.querySelector(`div[data-validation="${e}"]`);function i(){return t.remove("is-invalid"),t.add("is-valid"),!0}if(!o)t.add("is-invalid"),a.textContent="欄位不可空白";else if(e==="account")if(!/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(o))t.remove("is-valid"),t.add("is-invalid"),a.textContent="信箱格式不正確";else return i();else if(e==="password")if(!/\w{6,}/.test(o))t.remove("is-valid"),t.add("is-invalid"),a.textContent="長度需在六個字以上";else return i();else if(e==="password-confirm")if(o!==r.value)t.remove("is-valid"),t.add("is-invalid"),a.textContent="兩次密碼不一致";else return i();else return i()}d.addEventListener("click",h,!1);function h(){console.log(s(c),s(u),s(r),s(m)),s(c)&&s(u)&&s(r)&&s(m)&&w({email:u.value,password:r.value,name:c.value,role:"member"})}function w(n){d.setAttribute("disabled",!0),E.post(`${b}/signup`,n).then(e=>{d.removeAttribute("disabled"),l("success","註冊成功！請登入","login.html"),f()}).catch(e=>{if(e.message==="Network Error")l("error","無法連接伺服器，請聯絡管理員");else{const{data:o}=e.response;o=="Email already exists"&&l("error","用戶已存在"),f()}d.removeAttribute("disabled")})}function f(){v.forEach(n=>{n.value="",n.classList.remove("is-valid")})}
